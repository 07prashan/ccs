<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Capital Complaint System</title>
  <link rel="stylesheet" href="/css/index.css">
  <script src="js/index.js" defer></script>
</head>
<body>

  <!-- Header -->
  <header>
    <h1 class="main-title">Capital Complaint System</h1>
  </header>

  <!-- Navbar -->
  <div class="navbar">
    <nav>
      <a href="/home">Home</a>
      <a href="/dashboard">Dashboard</a>
      <a href="/post-complaint">Post a Complaint</a>
      <a href="/Complaint-history">Complaint History</a>
      <a href="/contact-us">Contact Us</a>
    </nav>
    <div class="profile-container">
      <div class="dropdown">
        <button class="dropbtn">Menu</button>
        <div class="dropdown-content">
          <a href="/settings">Settings</a>
          <a href="/profile">Profile</a>
          <a href="/logout">Logout</a>
        </div>
      </div>
    </div>
  </div>

  <main class="feeds-section">
    <h2>Recent Complaints</h2>
    <div id="complaints-container">
        <% if (complaints.length > 0) { %>
            <% complaints.forEach(complaint => { %>
              <div class="complaint-card">
                <h3 class="complaint-name"><%= complaint.complaintNumber %>: <%= complaint.description %></h3>
                <p class="complaint-details"><%= complaint.location %> | <%= new Date(complaint.regDate).toLocaleDateString() %></p>
                <% if (complaint.file) { %>
                  <div class="complaint-image-container">
                      <!-- Debug info -->
                      <small style="color: gray;">Debug: <%= complaint.file %></small>
                      <img 
                          src="/uploads/<%= complaint.file %>" 
                          alt="Complaint Image"
                          style="max-width: 100%; height: auto; margin: 10px 0;"
                          onerror="this.style.display='none'; console.error('Failed to load:', this.src);"
                      >
                  </div>
              <% } %>
                <p class="complaint-status"><%= complaint.status %></p>
            </div>
            <% }); %>
        <% } else { %>
            <p>No complaints yet.</p>
        <% } %>
    </div>
  </main>
  

  
</body>
</html>
